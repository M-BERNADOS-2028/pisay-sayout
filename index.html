<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PISAY SAYOUT</title>
  <!-- Import Firebase SDK -->
  <script type="module">
    // Import the functions you need from Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, orderBy, query } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    // Your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDemeKsWgQhIxa7fvWm3rf9F5AcOELBdaY",
      authDomain: "pisay-sayout.firebaseapp.com",
      projectId: "pisay-sayout",
      storageBucket: "pisay-sayout.appspot.com",
      messagingSenderId: "682766827567",
      appId: "1:682766827567:web:f7a51de6fe4865f3a706da",
      measurementId: "G-TVRP1413RD"
    };

    // Initialize Firebase and Firestore
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // DOM Elements
    const messageForm = document.getElementById("messageForm");
    const messageInput = document.getElementById("messageInput");
    const messageContainer = document.getElementById("messageContainer");

    // Add message to Firestore on form submit
    messageForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const messageText = messageInput.value;

      try {
        await addDoc(collection(db, "messages"), {
          text: messageText,
          timestamp: serverTimestamp()
        });
        messageInput.value = ""; // Clear input field
      } catch (error) {
        console.error("Error posting message: ", error);
      }
    });

    // Listen for new messages in real-time
    const messagesQuery = query(collection(db, "messages"), orderBy("timestamp", "desc"));
    onSnapshot(messagesQuery, (snapshot) => {
      messageContainer.innerHTML = ""; // Clear previous messages
      snapshot.forEach((doc) => {
        const message = doc.data().text;
        const messageDiv = document.createElement("div");
        messageDiv.textContent = message;
        messageContainer.appendChild(messageDiv);
      });
    });
  </script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>PISAY SAYOUT</h1>
  <form id="messageForm">
    <textarea id="messageInput" placeholder="Say something..."></textarea>
    <button type="submit">Post</button>
  </form>
  <div id="messageContainer"></div>
</body>
</html>
